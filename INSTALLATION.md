# Руководство по установке и запуску E-Soul v2.0

Этот документ описывает процесс установки и запуска обновленной версии проекта "Электронная душа" (E-Soul v2.0).

## Требования

Для работы с проектом необходимы следующие компоненты:

- Python 3.8 или выше
- Для работы с моделями:
  - Минимум 4 ГБ оперативной памяти для моделей до 1B параметров
  - Минимум 8 ГБ оперативной памяти для моделей 1-3B параметров
  - Рекомендуется наличие GPU с CUDA для больших моделей
- 5 ГБ свободного пространства на диске для базовой системы и моделей
- Доступ к интернету для загрузки моделей с Hugging Face

## Установка

### 1. Клонирование репозитория

```bash
git clone https://github.com/your-username/e-soul.git
cd e-soul
```

### 2. Создание виртуального окружения

```bash
python -m venv venv
```

### 3. Активация виртуального окружения

**Windows:**
```bash
venv\Scripts\activate
```

**Linux/Mac:**
```bash
source venv/bin/activate
```

### 4. Установка зависимостей

Базовые зависимости (обязательные):
```bash
pip install -r requirements-base.txt
```

Полный набор зависимостей, включая поддержку моделей и веб-интерфейса:
```bash
pip install -r requirements.txt
```

## Структура проекта

После установки вы увидите следующую структуру проекта:

```
e-soul/
├── config/
│   ├── config.json                 # Основной конфигурационный файл
│   └── templates/                  # Шаблоны промптов
├── data/                           # Директория для хранения данных
│   ├── soul/                       # Данные состояния души
│   └── cache/                      # Кэш для API запросов
├── models/                         # Директория для моделей
│   └── cache/                      # Кэш для загрузки моделей
├── web_static/                     # Статические файлы веб-интерфейса
├── hormonal_system.py              # Модуль гормональной системы
├── mortality_awareness.py          # Модуль осознания смертности
├── prompt_hierarchy.py             # Модуль иерархии промптов
├── model_manager.py                # Модуль управления моделями
├── updated_core_module.py          # Обновленный модуль ядра системы
├── web_interface.py                # Модуль веб-интерфейса
├── main.py                         # Главный скрипт запуска
├── requirements.txt                # Полный список зависимостей
├── requirements-base.txt           # Базовые зависимости
└── README.md                       # Описание проекта
```

## Настройка

### 1. Конфигурация проекта

Основная конфигурация находится в файле `config/config.json`. Вы можете настроить:

- Параметры гормональной системы
- Настройки осознания смертности
- Конфигурацию веб-интерфейса
- Параметры для работы с моделями

### 2. Настройка для Hugging Face

Для полноценной работы с Hugging Face Hub рекомендуется указать ваш токен API:

1. Получите токен API на сайте [Hugging Face](https://huggingface.co/settings/tokens)
2. Добавьте токен в конфигурационный файл:

```json
{
  "model": {
    "huggingface_token": "ваш_токен_здесь"
  }
}
```

## Запуск

### Запуск с веб-интерфейсом (рекомендуется)

```bash
python main.py --web-only
```

Откройте браузер и перейдите по адресу: [http://localhost:8080](http://localhost:8080)

### Запуск в интерактивном режиме

```bash
python main.py --interactive
```

### Запуск с нестандартной конфигурацией

```bash
python main.py --config path/to/config.json
```

## Работа с проектом

### Веб-интерфейс

Веб-интерфейс предоставляет следующие возможности:

1. **Панель мониторинга**: Отображение текущего состояния системы, включая:
   - Статус гормональной системы
   - Прогресс жизненного цикла
   - Статистику запросов и ответов

2. **Чат**: Взаимодействие с системой через диалоговый интерфейс

3. **Управление моделями**:
   - Поиск моделей на Hugging Face Hub
   - Загрузка и удаление моделей
   - Отслеживание процесса загрузки

4. **Управление ценностными блоками**:
   - Просмотр существующих блоков
   - Добавление новых блоков
   - Редактирование блоков

5. **Детали души**:
   - Подробная информация о всех компонентах системы
   - Состояние гормональной системы
   - Состояние осознания смертности

### Интерактивный режим

В интерактивном режиме доступны следующие команды:

- `help`, `помощь` - Показать список команд
- `exit`, `quit`, `выход` - Выйти из сессии
- `status`, `статус` - Показать текущий статус души
- `emotion`, `эмоции` - Показать текущее эмоциональное состояние
- `mortality`, `смертность` - Показать статус осознания смертности
- `values`, `ценности` - Показать ценностные блоки
- `models`, `модели` - Показать загруженные модели
- `regulate`, `регулировка` - Выполнить саморегуляцию

Любой другой ввод будет обработан как запрос к системе.

## Загрузка и использование моделей

### Через веб-интерфейс

1. Перейдите на вкладку "Модели"
2. Введите поисковый запрос в поле поиска
3. Нажмите "Поиск"
4. Выберите модель из списка и нажмите "Загрузить"
5. Дождитесь завершения загрузки

### Для использования существующих моделей

Если у вас уже есть скачанные модели Hugging Face, вы можете разместить их в директории `models/` следующим образом:

```
models/
├── model_name/
│   ├── config.json
│   ├── model.safetensors
│   └── tokenizer.json
```

## Устранение неполадок

### Проблема: Не запускается веб-интерфейс

**Решение:** Убедитесь, что установлены все зависимости из `requirements.txt`.
```bash
pip install -r requirements.txt
```

### Проблема: Ошибки при загрузке моделей

**Решение:** Проверьте наличие достаточного количества свободного места на диске и корректность токена Hugging Face.

### Проблема: Высокое потребление памяти

**Решение:** Используйте модели меньшего размера или уменьшите параметр `max_concurrent_thoughts` в конфигурации.

## Дополнительные сведения

- [Документация по архитектуре](ARCHITECTURE.md)
- [Документация по гормональной системе](docs/hormonal_system.md)
- [Документация по осознанию смертности](docs/mortality_awareness.md)
- [Примеры промптов](docs/prompt_examples.md)

## Контакты

При возникновении вопросов или проблем, пожалуйста, создайте Issue в репозитории проекта.
